---
title: "Better causal diagrammes (DAGS) for counterfactual data science"
corresponding: yes
date-format: short
execute:
  warning: false
  eval: true
  include: true
  echo: false
---



```{tikz}
#| label: fig-dag-dep-u-effect-selection
#| fig-cap: "Correlated undirected measurement error can dilute the estimates of true effects. Red path denotes biasing from sampling from cultures with unmeasured correlated error structures"
#| out-width: 80%
#| echo: false
\usetikzlibrary{positioning}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{arrows}
\usetikzlibrary{decorations.markings}

\tikzstyle{Arrow} = [->, thin, preaction = {decorate}]
\tikzset{>=latex}

% Define a simple decoration
\tikzstyle{cor} = [-, dotted, preaction = {decorate}]

\begin{tikzpicture}[every node/.append style={draw}]

\node [rectangle, draw=red] (S) at (0, 2) {S}
\node [rectangle, draw=red] (UAY) at (1, 2) {U$_{AY}$};
\node [rectangle, draw=white] (UA) at (3, 1) {U$_A$};
\node [rectangle, draw=white] (UY) at (3, 3) {U$_Y$};

\node [rectangle, draw=black] (A1) at (5, 1) {A$^{t1}$};
\node [rectangle, draw=black] (Y2) at (7, 1) {Y$^{t2}$};
\node [rectangle, draw=white] (Aeta1) at (5, 0) {A$^{t1}_\eta$};
\node [rectangle, draw=white] (Yeta2) at (7, 0) {Y$^{t2}_\eta$};


\draw [-latex, draw=black] (S) to (UAY);
\draw [-latex, draw=red] (UAY) to (UA);
\draw [-latex, draw=red] (UAY) to (UY);
\draw [-latex, draw=black] (UA) to (A1);
\draw [-latex, draw=red, bend left=30] (UY) to (Y2);
\draw [-latex, draw=black] (Aeta1) to (A1);
\draw [-latex, draw=black] (Yeta2) to (Y2);
\draw [cor, draw=red, bend left] (Aeta1) to (UA);

\end{tikzpicture}

```




```{r}
#| label: load-libraries
#| echo: false
#| include: false
#| eval: false

# for making graphs
library("tinytex")
library(extrafont)
loadfonts(device = "all")


# libraries for jb (when internet is not accessible)
# read libraries
source("/Users/joseph/GIT/templates/functions/libs2.R")

# read functions
source("/Users/joseph/GIT/templates/functions/funs.R")

# read data/ set to path in your computer
pull_path <-
  fs::path_expand(
    "/Users/joseph/v-project\ Dropbox/data/current/nzavs_13_arrow"
  )

# for saving models. # set path fo your computer
push_mods <-
  fs::path_expand(
    "/Users/joseph/v-project\ Dropbox/data/nzvs_mods/00drafts/23_perfectionism_ken"
  )

push_loc <- 
    fs::path_expand(
  "/Users/joseph/GIT/00_drafts/23-target-trial-meaning-religious-loss"
    )

```

## Abstract





```{r}
here::here()
```

## Introduction

```{tikz}
#| label: fig-dag-dep-udir-effect-confounders-3wave22
#| fig-cap: "Measurement error opens an additional pathway to confounding if either there are correlated errors, or a directed effect of the exposure on the errors of measured outcome."
#| out-width: 100%
#| echo: false
#| eval: true

\usetikzlibrary{positioning}

\usetikzlibrary{shapes.geometric}

\usetikzlibrary{arrows}

\usetikzlibrary{decorations}

\tikzstyle{Arrow} = [->, thin, preaction = {decorate}]

\tikzset{>=latex}

\tikzset{blackArrowRedTip/.style={

  decoration={markings, mark=at position 1 with {\arrow[red, thick]{latex}}},

  postaction={decorate},

  shorten >=0.4pt}}

% Define a simple decoration

\tikzstyle{cor} = [-, dotted, preaction = {decorate}]

\begin{tikzpicture}[{every node/.append style}=draw]

\node [rectangle, draw=white] (ULAY) at (0, 5) {$U_{L}$};

\node [rectangle, draw=white] (UA) at (5, 4) {$U_{A}$};

\node [rectangle, draw=white] (UY) at (10, 5) {$U_{Y}$};

\node [rectangle, draw=black] (L0) at (0, 2) {L$_{f(X_1\dots X_n)}^{t0}$};

\node [rectangle, draw=black] (A1) at (5, 2) {A$_{f(X_1\dots X_n)}^{t1}$};

\node [rectangle, draw=black] (Y2) at (10, 2) {Y$_{f(X_1\dots X_n)}^{t2}$};

\node [rectangle, draw=white] (Leta0) at (0, 0) {$\eta_L^{t0}$};

\node [rectangle, draw=white] (Aeta1) at (5, 0) {$\eta_A^{t1}$};

\node [rectangle, draw=white] (Yeta2) at (10, 0) {$\eta_Y^{t2}$};

\draw [-latex, draw=red] (ULAY) to (UA);

\draw [-latex, draw=red] (ULAY) to (UY);

\draw [-latex, draw=black] (UA) to (A1);

\draw [-latex, draw=red] (UY) to (Y2);

\draw [-latex, draw=black] (ULAY) to (L0);

\draw [-latex, draw=black] (Leta0) to (L0);

\draw [-latex, draw=black] (Leta0) to (Aeta1);

\draw [-latex, draw=black, bend right=30] (Leta0) to (Yeta2);

\draw [-latex, draw = black] (Aeta1) to (A1);

\draw [-latex, draw=black] (Yeta2) to (Y2);

\draw [-latex, draw=red] (Aeta1) to (UY);

\draw [-latex, draw=red] (Leta0) to (UA);

%\draw [-latex, draw=black] (Leta0) to (UA);

\draw [cor, draw=red, dashed,bend right=80] (ULAY) to (Leta0);

\draw [cor, draw=red, dashed, bend right = 80] (UA) to (Aeta1);

\draw [cor, draw=red, dashed, bend left = 80] (UY) to (Yeta2);

\end{tikzpicture}

```


